import numpy as np
import matplotlib.pyplot as plt

# ==================== ç”¨æˆ·è‡ªå®šä¹‰å‚æ•° ====================
# ä¸‰æŸå…‰çš„å…‰å¼º (ä»»æ„å•ä½ï¼Œå¦‚ W/mÂ²)
intensities = [1.0, 0.5, 0.2]  # [I1, I2, I3]

# ä¸‰æŸå…‰çš„åˆå§‹ç›¸ä½ï¼ˆå¼§åº¦ï¼‰ï¼Œç¬¬ä¸€æŸå…‰ç›¸ä½ä¸º0ï¼Œå…¶ä½™æ˜¯ç›¸å¯¹ç›¸ä½å·®
phases = [0.0, 0, 0]  # [Ï†1, Ï†2, Ï†3]

# æ³¢æ•°èŒƒå›´ (cmâ»Â¹)
k_start = 400
k_end = 40000
k_step = 0.1  # æ­¥é•¿ï¼Œè¶Šå°è¶Šç²¾ç»†

# =======================================================

# ç”Ÿæˆæ³¢æ•°æ•°ç»„
k_values = np.arange(k_start, k_end + k_step/2, k_step)  # åŒ…å« end

# å‡è®¾ä¸‰æŸå…‰ä¼ æ’­è·¯å¾„å®Œå…¨é‡åˆï¼ˆx=0ï¼‰ï¼Œåˆ™ç›¸ä½ä»…ç”±åˆå§‹ç›¸ä½å†³å®š
# æ€»ç”µåœºå¤æŒ¯å¹…ï¼šE_total = Î£ âˆšI_i * exp(1j * Ï†_i)
# æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰è·¯å¾„å·®å¯¼è‡´çš„ç›¸ä½é¡¹ï¼ˆæ¯”å¦‚ k*Î”xï¼‰ï¼Œå› ä¸ºé¢˜ç›®æœªæåŠç©ºé—´åˆ†ç¦»
# å¦‚æœä½ å¸Œæœ›åŠ å…¥è·¯å¾„å·®ï¼Œè¯·æ‰©å±•æ­¤æ¨¡å‹

sqrt_I = np.sqrt(intensities)  # ç”µåœºæŒ¯å¹…æ­£æ¯”äº sqrt(å…‰å¼º)

# è®¡ç®—æ¯ä¸ªæ³¢æ•°ä¸‹çš„æ€»å…‰å¼ºï¼ˆç”±äºæ²¡æœ‰è·¯å¾„å·®ï¼Œå…¶å®ä¸kæ— å…³ï¼Ÿï¼‰
# ä½†ï¼â€”â€” å¦‚æœä½ æƒ³æ¨¡æ‹Ÿâ€œç”±äºæ³¢é•¿å˜åŒ–å¯¼è‡´å›ºå®šè·¯å¾„å·®å¼•èµ·çš„ç›¸ä½å·®å˜åŒ–â€ï¼Œ
# é‚£ä¹ˆéœ€è¦å¼•å…¥è·¯å¾„å·® Î”xï¼Œæ­¤æ—¶ç›¸ä½å·® = k * Î”x

# ğŸ”º é‡è¦ä¿®æ­£ï¼šé€šå¸¸å¹²æ¶‰å®éªŒä¸­ï¼Œç›¸ä½å·®æ¥æºäºè·¯å¾„å·® Î”xï¼Œè€Œ Î”x æ˜¯å›ºå®šçš„ï¼Œ
# æ³¢æ•° k å˜åŒ– â†’ ç›¸ä½å·®å˜åŒ– â†’ å¹²æ¶‰æ¡çº¹å˜åŒ–ã€‚
# å› æ­¤ï¼Œæˆ‘ä»¬åº”å…è®¸ç”¨æˆ·è®¾ç½®è·¯å¾„å·®ï¼

# ==================== å¢å¼ºç‰ˆï¼šæ”¯æŒè·¯å¾„å·®è®¾ç½® ====================

# è®¾ç½®ä¸‰æŸå…‰ç›¸å¯¹äºå‚è€ƒç‚¹çš„è·¯å¾„å·®ï¼ˆå•ä½ï¼šcmï¼‰
# ä¾‹å¦‚ï¼špath_diffs = [0.0, 0.001, -0.0005] è¡¨ç¤ºç¬¬äºŒæŸå…‰å¤šèµ° 10 å¾®ç±³ï¼Œç¬¬ä¸‰æŸå°‘èµ° 5 å¾®ç±³
path_diffs = [0.0, 0.002, 0.004]  # å•ä½ï¼šå˜ç±³ï¼ˆcmï¼‰ï¼Œå› ä¸ºkå•ä½æ˜¯ cmâ»Â¹

# æ€»ç›¸ä½ = åˆå§‹ç›¸ä½ + k * è·¯å¾„å·®
# E_i = âˆšI_i * exp(1j * (Ï†_i + k * Î”x_i))

total_intensity = []

for k in k_values:
    E_total = 0j
    for i in range(3):
        phase_total = phases[i] + k * path_diffs[i]
        E_i = sqrt_I[i] * np.exp(1j * phase_total)
        E_total += E_i
    I_total = np.abs(E_total)**2
    total_intensity.append(I_total)

total_intensity = np.array(total_intensity)

# ==================== ç»˜å›¾ ====================
plt.figure(figsize=(12, 6))
plt.plot(k_values, total_intensity, 'b-', linewidth=1)
plt.title('ä¸‰æŸå…‰å¹²æ¶‰æ€»å…‰å¼º vs æ³¢æ•°', fontsize=16)
plt.xlabel('æ³¢æ•° (cm$^{-1}$)', fontsize=14)
plt.ylabel('æ€»å…‰å¼º (a.u.)', fontsize=14)
plt.grid(True, linestyle='--', alpha=0.7)
plt.xlim(k_start, k_end)
plt.tight_layout()
plt.show()

# å¯é€‰ï¼šæ‰“å°ä¸€äº›ç»Ÿè®¡ä¿¡æ¯
print(f"æœ€å°å…‰å¼º: {np.min(total_intensity):.4f}")
print(f"æœ€å¤§å…‰å¼º: {np.max(total_intensity):.4f}")
print(f"å¹³å‡å…‰å¼º: {np.mean(total_intensity):.4f}")