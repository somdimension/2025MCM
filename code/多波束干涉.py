import numpy as np
import matplotlib.pyplot as plt

def 模拟多波束干涉频谱_波数(波长范围, 薄膜厚度, 折射率, 入射角度=10):
    """
    模拟多波束干涉频谱，横坐标为波数(cm⁻¹)
    参数:
      波长范围: (最小波长, 最大波长, 采样点数量)，单位为纳米
      薄膜厚度: 薄膜厚度，单位为纳米
      折射率: 薄膜折射率（忽略色散）
      入射角度: 入射光角度，默认为0度（垂直入射）
    返回:
      波数数组 (cm⁻¹), 对应的反射率数组
    """
    最小波长, 最大波长, 采样点数 = 波长范围
    # 波长数组 (nm)
    波长数组 = np.linspace(最小波长, 最大波长, 采样点数)
    # 波数(cm⁻¹) = 1 / 波长(cm)
    波数数组 = 1 / (波长数组 * 1e-7)

    # 真空波数 (1/m)
    真空波数 = 2 * np.pi / (波长数组 * 1e-9)

    # 计算相位差
    角度弧度 = np.radians(入射角度)
    相位差 = 2 * 折射率 * 薄膜厚度 * 1e-9 * np.cos(角度弧度) * 真空波数

    # 计算反射率（简化无吸收模型）
    反射率 = (4 * np.sin(相位差 / 2)**2) / (1 + 4 * np.sin(相位差 / 2)**2)

    return 波数数组, 反射率

# 参数示例
波长起点 = 200    # nm
波长终点 = 8000    # nm
采样点数 = 100000
薄膜厚度 = 500   # nm
折射率 = 1.5
入射角度 = 0     # 度

# 计算波数谱
波数, 反射率 = 模拟多波束干涉频谱_波数(
    (波长起点, 波长终点, 采样点数),
    薄膜厚度,
    折射率,
    入射角度
)

# 绘制反射率-波数谱
plt.figure(figsize=(8, 4))
plt.plot(波数, 反射率, color='red')
plt.xlabel('波数 (cm⁻¹)')
plt.ylabel('反射率')
plt.title('多波束干涉模拟频谱（波数为横坐标）')
plt.grid(True)
plt.tight_layout()
plt.show()
